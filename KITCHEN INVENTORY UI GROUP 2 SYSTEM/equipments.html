<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Equipments</title>
    <link
      href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }
      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        height: 100%;
        width: 78px;
        background: #b82132;
        padding: 6px 14px;
        z-index: 99;
        transition: all 0.5s ease;
      }

      .sidebar.open {
        width: 250px;
      }
      .logo-details {
        display: flex;
        align-items: center;
        flex-direction: column;
        text-align: center;
      }
      .logo-details .logo-icon {
        width: auto;
        height: 60px;
        margin-top: 50px;
      }
      .sidebar .logo-details {
        height: 60px;
        display: flex;
        align-items: center;
        position: relative;
      }
      .sidebar .logo-details .icon {
        opacity: 0;
        transition: all 0.5s ease;
      }
      .sidebar .logo-details .logo_name {
        color: #fff;
        font-size: 20px;
        font-weight: 600;
        opacity: 0;
        transition: all 0.2s ease-in;
      }
      .sidebar.open .logo-details .icon,
      .sidebar.open .logo-details .logo_name {
        opacity: 1;
      }
      .sidebar .logo-details #btn {
        position: absolute;
        top: 50%;
        right: 0;
        transform: translateY(-50%);
        font-size: 22px;
        transition: all 0.4s ease;
        font-size: 23px;
        text-align: center;
        cursor: pointer;
        transition: all 0.5s ease;
      }
      .sidebar.open .logo-details #btn {
        text-align: right;
      }
      .sidebar i {
        color: #fff;
        height: 60px;
        min-width: 50px;
        font-size: 28px;
        text-align: center;
        line-height: 60px;
      }
      .sidebar .nav-list {
        padding-top: 10px;
        margin-top: 60px;
        height: 100%;
      }
      .sidebar li {
        position: relative;
        margin: 8px 0;
        list-style: none;
      }
      .sidebar li .tooltip {
        position: absolute;
        top: -20px;
        left: calc(100% + 15px);
        z-index: 3;
        background: #fff;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 15px;
        font-weight: 400;
        opacity: 0;
        white-space: nowrap;
        pointer-events: none;
        transition: 0s;
      }
      .sidebar li:hover .tooltip {
        opacity: 1;
        pointer-events: auto;
        transition: all 0.4s ease;
        top: 50%;
        transform: translateY(-50%);
      }
      .sidebar.open li .tooltip {
        display: none;
      }
      .sidebar li a {
        display: flex;
        height: 100%;
        width: 100%;
        border-radius: 12px;
        align-items: center;
        text-decoration: none;
        transition: all 0.4s ease;
        background: #b82132;
      }
      .sidebar li a:hover {
        background: #fff;
      }
      .sidebar li a .links_name {
        color: #fff;
        font-size: 15px;
        font-weight: 400;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: 0.4s;
      }
      .sidebar.open li a .links_name {
        opacity: 1;
        pointer-events: auto;
      }
      .sidebar li a:hover .links_name,
      .sidebar li a:hover i {
        transition: all 0.2s ease;
        color: #11101d;
      }
      .sidebar li i {
        height: 50px;
        line-height: 50px;
        font-size: 18px;
        border-radius: 12px;
      }

      /*close sidebar */
      @media (max-width: 1024px) {
        .sidebar {
          width: 100%;
          height: 60px;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 0 14px;
          position: fixed;
          top: 0;
          left: 0;
          flex-direction: row;
          background: #b82132;
          z-index: 100;
        }

        .sidebar #btn {
          font-size: 25px;
          cursor: pointer;
          position: relative;
          top: 45% !important;
          right: 1px !important;
          padding: 5px 5px;
          transform: translateY(-50%);
          z-index: 101;
          color: white;
        }

        .logo-details {
          flex: 1;
          text-align: center;
          position: relative;
        }

        .logo_name {
          margin-top: 20px;
        }

        .logo-details .logo-icon {
          height: 70px !important;
          width: auto;
          margin-top: 1px;
          padding-bottom: 5px;
        }

        .nav-list {
          display: none;
        }
      }

      @media (max-width: 768px) {
        .sidebar #btn {
          right: 30px;
        }
        .logo-details .logo-icon {
          height: 40px;
          width: auto;
          padding-bottom: 5px;
        }
      }

      @media (max-width: 600px) {
        .sidebar {
          height: 50px;
          padding: 0 10px;
        }
        .sidebar #btn {
          font-size: 22px;
          right: 20px;
        }
        .logo-details .logo-icon {
          height: 60px !important;
          width: auto;
          margin-bottom: 6px;
        }
      }

      @media (max-width: 450px) {
        .sidebar {
          height: 45px;
          padding: 30px 0px !important;
        }
        .sidebar #btn {
          font-size: 20px;
          right: 10px;
        }
        .logo-details .logo-icon {
          height: 30px;
          width: auto;
          margin-top: 1px;
        }
      }

      /*open sidebar */
      @media (max-width: 1024px) {
        .sidebar.open {
          height: auto;
          width: 100%;
          flex-direction: column;
          align-items: center;
          padding: 100px 0px 390px 0px;
        }

        .sidebar.open .nav-list {
          display: flex;
          flex-direction: column;
          width: 100%;
          margin-bottom: 30px;
          margin-right: 20px;
          margin-top: 10px;
        }

        .sidebar.open li {
          width: 100%;
          text-align: center;
        }

        .sidebar.open li a {
          width: 100%;
          justify-content: center;
        }

        .sidebar.open li a:hover {
          background: none;
        }

        .sidebar.open #btn {
          position: absolute;
          top: 1px;
          left: 200px;
        }

        .logo-details .logo-icon {
          height: 30px;
          width: auto;
        }
      }

      @media (max-width: 768px) {
        .sidebar.open {
          padding: 120px 0px;
        }
        .sidebar.open #btn {
          left: 200px !important;
        }

        .sidebar.open li a {
          width: 100%;
          justify-content: center;
        }
      }

      @media (max-width: 600px) {
        .sidebar.open {
          padding: 100px 0px 250px 0px;
        }
        .sidebar.open #btn {
          left: 100px;
        }
        .sidebar.open li a {
          width: 100%;
          justify-content: center;
        }
      }

      @media (max-width: 450px) {
        .sidebar.open {
          padding: 40px 0px 20vh 0px !important;
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        .sidebar.open #btn {
          left: 100px;
        }
        .sidebar.open ul {
          width: 100%;
          margin: 0;
          padding: 0;
        }
        .sidebar.open li {
          width: 100%;
          margin: 0;
          padding: 0;
        }
        .sidebar.open li a {
          width: 100%;

          display: flex;
        }
      }
      .utensils-nav {
        padding: 10px 20px;
        position: absolute;
        top: 180px;
        left: 50%;
        transform: translateX(-50%);
        margin-bottom: 50px;
        width: 90%;
        max-width: 1200px;
      }

      .utensilshead {
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-size: clamp(35px, 3.5vw, 40px);
        margin-top: 100px;
      }

      .icon {
        width: 40px;
        height: auto;
        margin-left: 10px;
      }

      .utensils-nav ul {
        display: flex;
        gap: 5px;
        padding: 0;
        margin: 0;
        justify-content: center;
        position: relative;
        flex-wrap: wrap;
      }

      .utensils-nav ul::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 1px;
        width: 100%;
      }

      .utensils-nav ul li {
        display: inline-block;
        padding-bottom: 8px;
      }

      .utensils-nav ul li a {
        text-decoration: none;
        color: black;
        font-weight: 500;
        font-size: 16px;
        padding: 1px 12px;
        position: relative;
        transition: color 0.3s;
        display: inline-block;
        min-width: 20px;
      }

      .utensils-nav ul li a::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: -8px;
        width: 0;
        height: 2px;
        background: #b82132;
        z-index: 1;
      }

      .utensils-nav ul li a:hover::after,
      .utensils-nav ul li a:focus::after {
        width: 100%;
      }

      .utensils-nav ul li a:hover,
      .utensils-nav ul li a:focus {
        color: #b82132;
      }

      .utensils-nav ul li a.clicked {
        color: #b82132;
      }

      .utensils-nav a.active {
        color: #b82132;
      }

      .utensils-nav a.active::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 0;
        right: 0;
        height: 2px;
        background-color: #b82132;
        width: 100%;
        z-index: 1;
      }

      @media screen and (max-width: 768px) {
        .utensils-nav {
          top: 150px;
          width: 95%;
          padding: 10px 15px;
        }

        .utensilshead {
          margin-top: 80px;
          font-size: clamp(30px, 3.5vw, 35px);
        }

        .icon {
          width: 35px;
        }

        .utensils-nav ul {
          gap: 10px;
          justify-content: flex-start;
          padding-bottom: 3px;
        }

        .utensils-nav ul li a {
          font-size: 16px;
          padding: 1px 10px;
        }
      }

      @media screen and (min-width: 769px) and (max-width: 888px) {
        .utensils-nav {
          top: 150px;
          width: 95%;
          padding: 10px 15px;
        }

        .utensilshead {
          margin-top: 100px;
          font-size: clamp(30px, 3.5vw, 35px);
        }

        .icon {
          width: 35px;
        }

        .utensils-nav ul {
          gap: 10px;
          justify-content: flex-start;
          padding-bottom: 3px;
        }

        .utensils-nav ul li a {
          font-size: 16px;
          padding: 1px 10px;
        }
      }

      @media screen and (max-width: 600px) {
        .utensils-nav {
          width: 100%;
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
        }

        .utensils-nav ul {
          flex-wrap: nowrap;
          width: max-content;
          padding-bottom: 5px;
        }

        .utensils-nav::-webkit-scrollbar {
          display: none;
        }

        .utensils-nav {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
      }

      @media screen and (min-width: 1200px) {
        .utensils-nav {
          max-width: 1400px;
          justify-content: center;
          align-items: center;
          margin-left: 25px;
          padding-bottom: 20px;
        }

        .utensils-nav ul {
          justify-content: center;
          align-items: center;
          gap: 50px;
        }

        .utensils-nav ul li a {
          font-size: 18px;
          justify-content: center;
          align-items: center;
        }
      }

      @media screen and (max-width: 1199.98px) {
        .utensils-nav {
          max-width: 100%;
          padding: 10px 15px;
          justify-content: center;
          align-items: center;
        }

        .utensils-nav ul {
          gap: 15px;
          justify-content: center;
          align-items: center;
        }

        .utensils-nav ul li a {
          font-size: 18px;
          padding: 1px 8px;
          align-items: center;
        }
      }

      .section {
        display: none;
        margin-top: 150px;
      }

      .section.active {
        display: block;
      }

      .utensils-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        padding: 20px;
        margin: 120px auto 0;
        width: 100%;
        max-width: 1200px;
        justify-content: center;
        align-items: center;
      }

      .empty-card {
        visibility: hidden;
        height: 0;
        padding: 0;
        margin: 0;
        border: none;
      }

      .card {
        display: flex;
        flex-direction: column;
        align-items: center;
        border: 1px solid #ddd;
        border-radius: 12px;
        overflow: hidden;
        padding: 23px 10px 16px 17px;
        text-align: center;
        background: white;
        transition: box-shadow 0.3s ease;
        animation: downToUp 0.3s ease-out;
      }

      @keyframes downToUp {
        0% {
          opacity: 0;
          transform: translateY(20px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .card:hover {
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      }

      /* Card Image */
      .card img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        margin-bottom: 10px;
      }

      /* Card Text */
      .card h3 {
        font-size: 18px;
        font-weight: 500;
        margin-bottom: 8px;
      }

      /* Item Indicator */
      .item-indicator {
        font-size: 14px;
        font-weight: bold;
        padding: 5px 10px;
        border-radius: 6px;
        color: white;
        display: inline-block;
        margin: 10px 0;
      }

      .green {
        background: #4caf50;
      }
      .orange {
        background: #dab600;
      }
      .red {
        background: #f0750f;
      }

      .card-buttons {
        display: flex;
        justify-content: space-between;
        width: 100%;
        gap: 10px;
      }

      .card-buttons button {
        flex: 1;
        padding: 0px 15px;
        border: none;
        border-radius: 10px;
        font-size: 13px;
        cursor: pointer;
        transition: background 0.3s;
        margin-top: 20px;
      }

      .return-btn {
        background: #4779c4;
        color: #fff;
      }

      .return-btn:hover {
        background: #0056b3;
      }

      @media (min-width: 1025px) and (max-width: 1629px) {
        .utensils-cards {
          grid-template-columns: repeat(auto-fit, minmax(165px, 1fr));
          gap: 20px;
          max-width: 1200px;
          margin: 50px auto 0;
          padding-top: 60px;
          padding-left: 100px;
          padding-right: 20px;
          justify-content: center;
        }

        .section {
          display: none;
          margin-top: 150px;
        }
        .card {
          padding: 23px 10px 16px 17px;
        }

        .card img {
          width: 100px;
          height: 100px;
        }

        .card h3 {
          font-size: 18px;
        }

        .item-indicator {
          font-size: 15px;
          padding: 5px 10px;
        }

        .card-buttons button {
          font-size: 12px;
          padding: 0px 8px;
        }
      }

      @media (max-width: 1024px) {
        .utensils-cards {
          gap: 25px;
          padding-left: 20px;
          padding-right: 20px;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }

        .card {
          padding: 15px 10px;
        }

        .card img {
          width: auto;
          height: 100px;
        }

        .card h3 {
          font-size: 16px;
        }

        .card-buttons button {
          font-size: 12px;
          padding: 0px 8px;
        }
      }

      @media (max-width: 768px) {
        .utensils-cards {
          gap: 40px;
          padding: 10px;
        }

        .section {
          display: none;
          margin-top: 180px;
        }
        .card {
          padding: 10px 8px;
        }

        .card img {
          width: auto;
          height: 80px;
        }

        .card h3 {
          font-size: 14px;
        }

        .card-buttons button {
          font-size: 11px;
          padding: 0px 6px;
        }
      }

      @media (min-width: 481px) and (max-width: 726px) {
        .utensils-cards {
          grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
          gap: 28px;
          padding: 30px 10px 0;
        }

        .card {
          padding: 10px 8px;
        }

        .card img {
          width: 70px;
          height: 70px;
        }

        .card h3 {
          font-size: 14px;
        }

        .card-buttons button {
          font-size: 11px;
          padding: 2px 10px;
        }
      }

      @media (max-width: 480px) {
        .utensils-cards {
          grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
          gap: 25px;

          padding: 30px 10px 0;
        }

        .card {
          padding: 8px 5px;
        }

        .card img {
          width: 70px;
          height: 70px;
        }

        .card h3 {
          font-size: 13px;
        }

        .card-buttons button {
          font-size: 10px;
          padding: 4px 4px;
        }
      }

      @media (max-width: 375px) {
        .utensils-cards {
          gap: 6px;
          padding: 25px 20px 0;
        }

        .card {
          padding: 15px 6px;
        }

        .card img {
          width: 60px;
          height: 60px;
        }

        .card h3 {
          font-size: 13px;
        }

        .card-buttons button {
          font-size: 10px;
          padding: 0px 15px;
        }
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      .modal.show {
        display: flex;
      }

      .modal-content {
        background-color: white;
        border-radius: 12px;
        width: 90%;
        max-width: 400px;
        padding: 20px;
        position: relative;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      }

      .modal-close {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 24px;
        cursor: pointer;
        color: #999;
        transition: color 0.3s ease;
      }

      .modal-close:hover {
        color: #b82132;
      }

      .modal-header {
        text-align: center;
        margin-bottom: 20px;
      }

      .modal-body {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .modal-input {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .modal-input label {
        font-weight: 500;
      }

      .modal-input input {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 6px;
      }

      .quantity-control {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .quantity-control button {
        background: white;
        color: white;
        border: none;
        padding: 5px 15px;
        border-radius: 6px;
        cursor: pointer;
      }

      .quantity-control input {
        width: 50px;
        text-align: center;
      }

      .modal-footer {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }

      .modal-footer button {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .modal-content {
        background-color: white;
        border-radius: 12px;
        width: 90%;
        max-width: 400px;
        padding: 20px 20px;
        position: relative;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      }

      .modal-close,
      .modal-close-pw {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 24px;
        cursor: pointer;
        color: #999;
        transition: color 0.3s ease;
      }

      .modal-close:hover,
      .modal-close-pw:hover {
        color: #b82132;
      }

      .modal-submit {
        background: #4779c4;
        color: white;
      }

      .modal-submit:hover {
        background: #0056b3;
      }

      .modal-cancel {
        color: black;
      }

      .modal-cancel:hover {
        background: #ddd;
      }

      .modal-footer button {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .modal-submit,
      .modal-confirm-pw {
        background: #4779c4;
        color: #fff;
      }

      .modal-submit:hover,
      .modal-confirm-pw:hover {
        background: #0056b3;
      }

      .modal-cancel,
      .modal-cancel-pw {
        color: black;
      }

      .modal-cancel:hover,
      .modal-cancel-pw:hover {
        background: #ddd;
      }

      .return-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      .return-modal.show {
        display: flex;
      }

      .return-modal-content {
        background-color: white;
        border-radius: 16px;
        width: 90%;
        max-width: 600px;
        padding: 30px;
        position: relative;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        max-height: 90vh;
        overflow-y: auto;
      }

      .return-modal-close {
        position: absolute;
        top: 15px;
        right: 15px;
        font-size: 24px;
        cursor: pointer;
        color: #888;
        transition: all 0.3s ease;
      }

      .return-modal-close:hover {
        color: #b82132;
      }

      .return-modal-header {
        text-align: center;
        margin-bottom: 25px;
      }

      .return-modal-header h2 {
        color: black;
        margin: 0;
        font-size: 1.8rem;
        font-weight: 700;
      }

      .return-modal-body {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .return-modal-input {
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin-bottom: 15px;
      }

      .return-modal-input label {
        font-weight: 600;
        color: black;
        font-size: 0.9rem;
      }

      .return-modal-input input,
      .return-modal-input textarea {
        padding: 10px;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        font-size: 0.95rem;
        transition: border-color 0.3s ease;
      }

      .return-modal-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 15px;
      }

      .return-condition-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        padding: 15px;
        border-radius: 10px;
      }

      .return-condition-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
      }

      .return-condition-item label {
        font-size: 0.8rem;
        color: black;
      }

      .return-condition-item input {
        width: 70px;
        text-align: center;
        padding: 6px;
        border: 1px solid #ddd;
        border-radius: 6px;
      }

      .return-modal-condition-report {
        text-align: center;
        width: 100%;
      }

      .return-modal-condition-report .return-modal-input {
        max-width: 600px;
        margin: 0 auto;
      }

      .return-modal-footer {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }

      .return-modal-footer button {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .return-modal-submit {
        background: #4779c4;
        color: #fff;
      }

      .return-modal-submit:hover {
        background: #0056b3;
      }

      .return-modal-cancel {
        background: #f0f0f0;
        color: #333;
      }

      .return-modal-cancel:hover {
        background: #ddd;
      }

      @media (max-width: 768px) {
        .return-modal-content {
          padding: 25px;
        }

        .return-modal-row {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .return-condition-grid {
          grid-template-columns: repeat(3, 1fr);
          gap: 10px;
          padding: 10px;
        }

        .return-modal-header h2 {
          font-size: 1.6rem;
        }
      }

      @media (max-width: 480px) {
        .return-modal-content {
          padding: 20px;
          width: 95%;
        }

        .return-modal-header h2 {
          font-size: 1.4rem;
        }

        .return-condition-grid {
          grid-template-columns: 1fr;
          gap: 8px;
        }

        .return-condition-item {
          flex-direction: row;
          justify-content: space-between;
          align-items: center;
        }

        .return-condition-item input {
          width: 60px;
        }

        .return-modal-footer {
          flex-direction: column;
          gap: 10px;
        }

        .return-modal-footer button {
          width: 100%;
        }
      }

      @media (max-width: 360px) {
        .return-modal-content {
          padding: 15px;
        }

        .return-modal-header h2 {
          font-size: 1.3rem;
        }

        .return-modal-input label {
          font-size: 0.85rem;
        }

        .return-modal-input input,
        .return-modal-input textarea {
          padding: 8px;
          font-size: 0.9rem;
        }

        .return-condition-item label {
          font-size: 0.75rem;
        }

        .return-condition-item input {
          width: 50px;
          padding: 5px;
        }
      }

      /* Updated Logout Modal Styles */
      .logout-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .logout-modal.show {
        display: flex;
        opacity: 1;
      }

      .logout-modal-content {
        background-color: white;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transform: translateY(20px);
        opacity: 0;
        transition: all 0.3s ease;
      }

      .logout-modal.show .logout-modal-content {
        transform: translateY(0);
        opacity: 1;
      }

      .logout-warning-icon {
        width: 80px;
        height: 80px;
        background-color: #b82132;
        border-radius: 50%;
        margin: 0 auto 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        animation: pop-in 0.4s ease-out forwards;
      }

      .logout-warning-icon svg {
        width: 40px;
        height: 40px;
        fill: none;
        stroke: white;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
      }

      .logout-modal h3 {
        margin-bottom: 10px;
        color: black;
        font-size: 24px;
      }

      .logout-modal p {
        color: black;
        margin-bottom: 25px;
      }

      .logout-modal-footer {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 20px;
      }

      .logout-btn-confirm,
      .logout-btn-cancel {
        padding: 12px 30px;
        border: none;
        border-radius: 30px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }

      .logout-btn-confirm {
        background-color: #b82132;
        color: white;
      }

      .logout-btn-confirm:hover {
        background-color: #a11d2c;
      }

      .logout-btn-cancel {
        background-color: #f1f1f1;
        color: #333;
      }

      .logout-btn-cancel:hover {
        background-color: #ddd;
      }

      @media (max-width: 480px) {
        .logout-modal-content {
          padding: 30px;
          width: 85%;
        }

        .logout-modal-footer {
          flex-direction: column;
          gap: 10px;
        }

        .logout-btn-confirm,
        .logout-btn-cancel {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <div class="logo-details">
        <img src="images/datamesian.PNG" alt="Logo" class="logo-icon" />
        <div class="logo_name">KITCHEN INVENTORY</div>
        <i class="bx bx-menu" id="btn"></i>
      </div>

      <ul class="nav-list">
        <li>
          <a href="index.html">
            <i class="bx bxs-home"></i>
            <span class="links_name">Home</span>
          </a>
          <span class="tooltip">Home</span>
        </li>
        <li>
          <a href="utensils.html">
            <i class="fa-solid fa-utensils"></i>
            <span class="links_name">Utensils</span>
          </a>
          <span class="tooltip">Utensils</span>
        </li>
        <li>
          <a href="equipments.html">
            <i class="fa-solid fa-kitchen-set"></i>
            <span class="links_name">Equipments</span>
          </a>
          <span class="tooltip">Equipments</span>
        </li>
        <li>
          <a href="kitchenapp.html">
            <i class="fa-solid fa-blender"></i>
            <span class="links_name"> Appliances</span>
          </a>
          <span class="tooltip"> Appliances</span>
        </li>
        <li>
          <a href="history.html">
            <i class="fa-solid fa-clock-rotate-left"></i>
            <span class="links_name">History</span>
          </a>
          <span class="tooltip">History</span>
        </li>
        <li>
          <a href="profile.html">
            <i class="fa-solid fa-user"></i>
            <span class="links_name">Profile</span>
          </a>
          <span class="tooltip">Profile</span>
        </li>
        <li>
          <a href="contact.html">
            <i class="bx bxs-contact"></i>
            <span class="links_name">Contact</span>
          </a>
          <span class="tooltip">Contact</span>
        </li>
        <li>
          <a href="#" id="logoutLink">
            <i class="bx bx-log-out"></i>
            <span class="links_name">Logout</span>
          </a>
          <span class="tooltip">Logout</span>
        </li>
      </ul>
    </div>

    <h1 class="utensilshead">
      Equipments
      <img src="images/kitchen-tool.png" alt="Icon" class="icon" />
    </h1>

    <nav class="utensils-nav">
      <ul>
        <li>
          <a href="#" class="nav-link active" data-target="BakingPastry"
            >Baking & Pastry Equipment</a
          >
        </li>
        <li>
          <a href="#" class="nav-link" data-target="CookingEquipment"
            >Cooking Equipment</a
          >
        </li>

        <li>
          <a href="#kitchen-tools" class="nav-link" data-target="FoodProcessing"
            >Food Processing Equipment</a
          >
        </li>

        <li>
          <a
            href="#kitchen-tools"
            class="nav-link"
            data-target="MiscellaneousEquipment"
            >Miscellaneous Equipment</a
          >
        </li>
      </ul>
    </nav>

    <!-- Utensils section without the navigation -->
    <section class="utensils">
      <!-- All Utensils Section -->

      <!-- Baking & Pastry Equipment -->
      <div class="section BakingPastry active">
        <div class="utensils-cards">
          <div class="card">
            <img src="allequipments/bakingsheet.png" alt="Soup Spoon" />
            <h3>Baking Sheet</h3>
            <div class="item-indicator green">10/10</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/cakestand.png" alt="Soup Spoon" />
            <h3>Cake Stand</h3>
            <div class="item-indicator green">10/10</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/muffinpan.png" alt="Soup Spoon" />
            <h3>Muffin Pan Small</h3>
            <div class="item-indicator green">7/7</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/pieplate.png" alt="Soup Spoon" />
            <h3>Pie Pan Large</h3>
            <div class="item-indicator green">4/4</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/roundbaking.png" alt="Soup Spoon" />
            <h3>Round Baking Pan</h3>
            <div class="item-indicator green">1/1</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>
        </div>
      </div>

      <!-- CookingEquipment -->
      <div class="section CookingEquipment">
        <div class="utensils-cards">
          <div class="card">
            <img src="allequipments/boilingpot.png" alt="Whisk" />
            <h3>Boiling Pot</h3>
            <div class="item-indicator green">3/3</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/carajay.png" alt="Whisk" />
            <h3>Carajay</h3>
            <div class="item-indicator green">14/14</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/casserole.png" alt="Whisk" />
            <h3>Casserole</h3>
            <div class="item-indicator green">9/9</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/stockpot.png" alt="Whisk" />
            <h3>Stock Pot</h3>
            <div class="item-indicator green">10/10</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/saucepan.png" alt="Whisk" />
            <h3>Sauce Pan</h3>
            <div class="item-indicator green">6/6</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/steamer.png" alt="Whisk" />
            <h3>Steamer</h3>
            <div class="item-indicator green">1/1</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Food Processing Equipment-->
      <div class="section FoodProcessing">
        <div class="utensils-cards">
          <div class="card">
            <img src="allequipments/pastamaker.png" alt="Blender" />
            <h3>Pasta Maker</h3>
            <div class="item-indicator green">1/1</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/pepper-mill.png" alt="Blender" />
            <h3>Pepper Mill</h3>
            <div class="item-indicator green">2/2</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/pestle.png" alt="Blender" />
            <h3>Pestle</h3>
            <div class="item-indicator green">2/2</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="empty-card"></div>
          <div class="empty-card"></div>
        </div>
      </div>

      <!-- MiscellaneousEquipment-->
      <div class="section MiscellaneousEquipment">
        <div class="utensils-cards">
          <div class="card">
            <img src="allequipments/doubleboiler.png" alt="Blender" />
            <h3>Double Boiler</h3>
            <div class="item-indicator green">3/3</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>

          <div class="card">
            <img src="allequipments/thermometer.png" alt="Blender" />
            <h3>Thermometer</h3>
            <div class="item-indicator green">3/3</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>
          <div class="card">
            <img src="allequipments/foodtrolley.png" alt="Blender" />
            <h3>Dish Trolley Stainless</h3>
            <div class="item-indicator green">2/2</div>
            <div class="card-buttons">
              <button>Borrow</button>
              <button class="return-btn">Item Return</button>
            </div>
          </div>
          <div class="empty-card"></div>
          <div class="empty-card"></div>
        </div>
      </div>

      <!--MODAL FOR BORROWED ITEM-->
      <div id="borrowModal" class="modal">
        <div class="modal-content">
          <span class="modal-close">&times;</span>
          <div class="modal-header">
            <h2>Borrow Item</h2>
          </div>
          <div class="modal-body">
            <div class="modal-input">
              <label for="studentName">Student Name</label>
              <input type="text" id="studentName" value="EYSUUUU" readonly />
            </div>
            <div class="modal-input">
              <label for="studentCourse">Course</label>
              <input
                type="text"
                id="studentCourse"
                value="H.M - 2 A"
                readonly
              />
            </div>
            <div class="modal-input">
              <label for="itemName">Item Name</label>
              <input type="text" id="itemName" readonly />
            </div>
            <div class="modal-input">
              <label for="borrowDate">Borrow Date & Time</label>
              <input type="text" id="borrowDate" readonly />
            </div>
            <div class="modal-input">
              <label>Quantity</label>
              <div class="quantity-control">
                <button id="decreaseQuantity" type="button">➖</button>
                <input type="number" id="quantity" value="1" min="1" readonly />
                <button id="increaseQuantity" type="button">➕</button>
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button class="modal-cancel">Cancel</button>
            <button class="modal-submit">Borrow</button>
          </div>
        </div>
      </div>

      <!-- Password Confirmation Modal -->
      <div id="passwordModal" class="modal">
        <div class="modal-content">
          <span class="modal-close-pw">&times;</span>
          <div class="modal-header">
            <h2>Verify your identity to borrow this item</h2>
          </div>
          <div class="modal-body">
            <div class="modal-input">
              <label for="password">Enter your password to proceed</label>
              <input
                type="password"
                id="password"
                placeholder="Enter password to confirm"
                required
              />
              <p
                id="passwordError"
                class="error-message"
                style="color: red; display: none"
              >
                Incorrect password. Please try again.
              </p>
            </div>
          </div>
          <div class="modal-footer">
            <button class="modal-cancel-pw">Cancel</button>
            <button class="modal-confirm-pw">Confirm</button>
          </div>
        </div>
      </div>

      <!--MODAL FOR RETURNED ITEM-->
      <div id="returnModal" class="return-modal">
        <div class="return-modal-content">
          <span class="return-modal-close">&times;</span>
          <div class="return-modal-header">
            <h2>Return Item</h2>
          </div>

          <div class="return-modal-row">
            <div class="return-modal-input">
              <label for="studentNameReturn">Student Name</label>
              <input
                type="text"
                id="studentNameReturn"
                value="Ace Flores"
                readonly
              />
            </div>
            <div class="return-modal-input">
              <label for="studentCourseReturn">Course</label>
              <input
                type="text"
                id="studentCourseReturn"
                value="H.M - 2 A"
                readonly
              />
            </div>
          </div>

          <div class="return-modal-row">
            <div class="return-modal-input">
              <label for="itemNameReturn">Item Name</label>
              <input type="text" id="itemNameReturn" readonly />
            </div>
            <div class="return-modal-input">
              <label for="totalBorrowedReturn">Total Borrowed</label>
              <input type="text" id="totalBorrowedReturn" value="" readonly />
            </div>
          </div>

          <div class="return-modal-row">
            <div class="return-modal-input">
              <label for="dateReturnedReturn">Date Returned</label>
              <input type="text" id="dateReturnedReturn" readonly />
            </div>
            <div class="return-modal-input">
              <label>Item Condition</label>
              <div class="return-condition-grid">
                <div class="return-condition-item">
                  <label>Good</label>
                  <input type="number" id="conditionGood" min="0" value="0" />
                </div>
                <div class="return-condition-item">
                  <label>Damaged</label>
                  <input
                    type="number"
                    id="conditionDamaged"
                    min="0"
                    value="0"
                  />
                </div>
                <div class="return-condition-item">
                  <label>Missing</label>
                  <input
                    type="number"
                    id="conditionMissing"
                    min="0"
                    value="0"
                  />
                </div>
              </div>
            </div>
          </div>

          <div class="return-modal-condition-report">
            <div class="return-modal-input">
              <label for="conditionReport">Condition Report</label>
              <textarea
                id="conditionReport"
                rows="5"
                placeholder="Enter additional notes about the item's condition..."
              ></textarea>
            </div>
          </div>

          <div class="return-modal-footer">
            <button class="return-modal-cancel">Cancel</button>
            <button class="return-modal-submit">Return Item</button>
          </div>
        </div>
      </div>

      <div id="logoutModal" class="logout-modal">
        <div class="logout-modal-content">
          <div class="logout-warning-icon">
            <svg viewBox="0 0 24 24">
              <path
                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
              />
            </svg>
          </div>
          <h3>Logout Confirmation</h3>
          <p>Are you sure you want to log out?</p>
          <div class="logout-modal-footer">
            <button id="confirmLogout" class="logout-btn-confirm">
              Logout
            </button>
            <button id="cancelLogout" class="logout-btn-cancel">Cancel</button>
          </div>
        </div>
      </div>
    </section>

    <div id="logoutModal" class="logout-modal">
      <div class="logout-modal-content">
        <div class="logout-warning-icon">
          <svg viewBox="0 0 24 24">
            <path
              d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
            />
          </svg>
        </div>
        <h3>Logout Confirmation</h3>
        <p>Are you sure you want to log out?</p>
        <div class="logout-modal-footer">
          <button id="confirmLogout" class="logout-btn-confirm">Logout</button>
          <button id="cancelLogout" class="logout-btn-cancel">Cancel</button>
        </div>
      </div>
    </div>
    <script>
      // Sidebar functionality
      let sidebar = document.querySelector(".sidebar");
      let closeBtn = document.querySelector("#btn");

      closeBtn.addEventListener("click", () => {
        sidebar.classList.toggle("open");
        menuBtnChange();
      });

      function menuBtnChange() {
        if (sidebar.classList.contains("open")) {
          closeBtn.classList.replace("bx-menu", "bx-menu-alt-right");
        } else {
          closeBtn.classList.replace("bx-menu-alt-right", "bx-menu");
        }
      }

      // Navigation tabs functionality
      document.addEventListener("DOMContentLoaded", function () {
        const navLinks = document.querySelectorAll(".nav-link");

        navLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();

            navLinks.forEach((l) => l.classList.remove("active"));
            document.querySelectorAll(".section").forEach((section) => {
              section.classList.remove("active");
            });

            this.classList.add("active");
            const targetId = this.getAttribute("data-target");
            document.querySelector(`.${targetId}`).classList.add("active");
          });
        });
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Storage event listener for cross-page synchronization
        window.addEventListener("storage", function (event) {
          if (event.key === "borrowedItems") {
            borrowedItems = JSON.parse(event.newValue) || {};
            updateAllItemIndicators();
          }
        });

        // Load borrowed items from local storage or initialize empty object
        let borrowedItems =
          JSON.parse(localStorage.getItem("borrowedItems")) || {};

        // Modal elements
        const borrowModal = document.getElementById("borrowModal");
        const passwordModal = document.getElementById("passwordModal");
        const returnModal = document.getElementById("returnModal");
        const conditionModal =
          document.getElementById("conditionModal") || null;

        // Borrow modal elements
        const closeBtn = borrowModal.querySelector(".modal-close");
        const cancelBtn = borrowModal.querySelector(".modal-cancel");
        const borrowBtns = document.querySelectorAll(
          ".card-buttons > button:not(.return-btn)"
        );
        const submitBtn = borrowModal.querySelector(".modal-submit");

        const studentNameInput = borrowModal.querySelector("#studentName");
        const studentCourseInput = borrowModal.querySelector("#studentCourse");
        const itemNameInput = borrowModal.querySelector("#itemName");
        const quantityInput = borrowModal.querySelector("#quantity");
        const borrowDateInput = borrowModal.querySelector("#borrowDate");
        const decreaseBtn = borrowModal.querySelector("#decreaseQuantity");
        const increaseBtn = borrowModal.querySelector("#increaseQuantity");

        // Password modal elements
        const closePwBtn = passwordModal.querySelector(".modal-close-pw");
        const cancelPwBtn = passwordModal.querySelector(".modal-cancel-pw");
        const confirmPwBtn = passwordModal.querySelector(".modal-confirm-pw");
        const passwordInput = passwordModal.querySelector("#password");
        const passwordError = passwordModal.querySelector("#passwordError");

        // Return modal elements
        const returnCloseBtn = returnModal.querySelector(".return-modal-close");
        const returnCancelBtn = returnModal.querySelector(
          ".return-modal-cancel"
        );
        const returnBtns = document.querySelectorAll(".return-btn");
        const returnSubmitBtn = returnModal.querySelector(
          ".return-modal-submit"
        );

        const studentNameReturnInput =
          returnModal.querySelector("#studentNameReturn");
        const studentCourseReturnInput = returnModal.querySelector(
          "#studentCourseReturn"
        );
        const itemNameReturnInput =
          returnModal.querySelector("#itemNameReturn");
        const totalBorrowedInput = returnModal.querySelector(
          "#totalBorrowedReturn"
        );
        const dateReturnedInput = returnModal.querySelector(
          "#dateReturnedReturn"
        );
        const conditionGoodInput = returnModal.querySelector("#conditionGood");
        const conditionDamagedInput =
          returnModal.querySelector("#conditionDamaged");
        const conditionMissingInput =
          returnModal.querySelector("#conditionMissing");
        const conditionReportInput =
          returnModal.querySelector("#conditionReport");

        // Condition modal elements (if exists)
        let conditionModalClose,
          conditionModalSubmit,
          conditionItemNameInput,
          conditionReportTextarea;
        if (conditionModal) {
          conditionModalClose = conditionModal.querySelector(
            ".condition-modal-close"
          );
          conditionModalSubmit = conditionModal.querySelector(
            ".condition-modal-submit"
          );
          conditionItemNameInput =
            conditionModal.querySelector("#conditionItemName");
          conditionReportTextarea =
            conditionModal.querySelector("#conditionReport");
        }

        // Create validation container
        const validationContainer = document.createElement("div");
        validationContainer.className = "validation-container";
        validationContainer.style.cssText = `
              margin-top: 15px;
              padding: 12px;
              border-radius: 6px;
              background-color: #f8f9fa;
              border-left: 4px solid #6c757d;
              display: none;
              align-items: center;
          `;

        const validationIcon = document.createElement("span");
        validationIcon.style.cssText = `
              margin-right: 8px;
              font-size: 18px;
          `;

        const validationText = document.createElement("span");
        validationText.style.cssText = `
              font-size: 14px;
          `;

        validationContainer.appendChild(validationIcon);
        validationContainer.appendChild(validationText);
        document
          .querySelector(".return-condition-grid")
          .parentNode.appendChild(validationContainer);

        // Correct password
        const CORRECT_PASSWORD = "admin123";

        // Save borrowed items to local storage and dispatch event
        function saveBorrowedItems() {
          localStorage.setItem("borrowedItems", JSON.stringify(borrowedItems));
          // Dispatch storage event for current page
          const event = new Event("storage");
          event.key = "borrowedItems";
          event.newValue = JSON.stringify(borrowedItems);
          window.dispatchEvent(event);
        }

        // Update date and time
        function updateDateTime() {
          const now = new Date();
          borrowDateInput.value = now.toLocaleString();
          dateReturnedInput.value = now.toLocaleString();
        }

        // Function to get total quantity of an item
        function getTotalQuantity(itemName) {
          const card = Array.from(document.querySelectorAll(".card")).find(
            (card) => card.querySelector("h3").textContent === itemName
          );

          if (card) {
            const indicator = card.querySelector(".item-indicator");
            const [, totalStr] = indicator.textContent.split("/");
            return parseInt(totalStr);
          }
          return 0;
        }

        // Function to update all item indicators based on current quantities
        function updateAllItemIndicators() {
          const cards = document.querySelectorAll(".card");
          cards.forEach((card) => {
            const itemName = card.querySelector("h3").textContent;
            const total = getTotalQuantity(itemName);
            const borrowed = borrowedItems[itemName]
              ? borrowedItems[itemName].reduce(
                  (sum, record) => sum + record.quantity,
                  0
                )
              : 0;
            const current = total - borrowed;

            const indicator = card.querySelector(".item-indicator");
            indicator.textContent = `${current}/${total}`;

            // Remove all color classes first
            indicator.classList.remove("green", "yellow", "orange");

            // Apply the appropriate color class
            if (current <= 0) {
              indicator.classList.add("orange");
            } else if (total === 1) {
              indicator.classList.add("green");
            } else if (total <= 4) {
              if (current <= 1) {
                indicator.classList.add("yellow");
              } else {
                indicator.classList.add("green");
              }
            } else if (current <= Math.max(2, Math.ceil(total * 0.25))) {
              indicator.classList.add("yellow");
            } else {
              indicator.classList.add("green");
            }
          });
        }

        // Function to get current quantity of an item
        function getCurrentQuantity(itemName) {
          const total = getTotalQuantity(itemName);
          const borrowed = borrowedItems[itemName]
            ? borrowedItems[itemName].reduce(
                (sum, record) => sum + record.quantity,
                0
              )
            : 0;
          return total - borrowed;
        }

        // Initialize all item indicators
        function initializeIndicators() {
          updateAllItemIndicators();
        }

        // Open borrow modal
        function openBorrowModal(itemName) {
          const currentQuantity = getCurrentQuantity(itemName);
          if (currentQuantity <= 0) {
            showErrorAlert(`Cannot borrow ${itemName} - item is out of stock`);
            return;
          }

          quantityInput.value = 1;
          quantityInput.max = currentQuantity;
          itemNameInput.value = itemName;
          updateDateTime();
          borrowModal.classList.add("show");
        }

        // Close borrow modal
        function closeBorrowModal() {
          borrowModal.classList.remove("show");
        }

        // Open password modal
        function openPasswordModal() {
          passwordInput.value = "";
          passwordError.style.display = "none";
          passwordModal.classList.add("show");
        }

        // Close password modal
        function closePasswordModal() {
          localStorage.removeItem("tempBorrowData");
          passwordModal.classList.remove("show");
        }

        // Open return modal with validation
        function openReturnModal(itemName) {
          itemNameReturnInput.value = itemName;
          totalBorrowedInput.value = "0";
          dateReturnedInput.value = "";
          conditionGoodInput.value = "0";
          conditionDamagedInput.value = "0";
          conditionMissingInput.value = "0";
          conditionReportInput.value = "";
          validationContainer.style.display = "none";

          if (
            !borrowedItems[itemName] ||
            borrowedItems[itemName].length === 0
          ) {
            showErrorAlert(
              `No borrowed records found for ${itemName}. Please borrow first.`
            );
            return;
          }

          const totalBorrowed = borrowedItems[itemName].reduce(
            (sum, record) => sum + record.quantity,
            0
          );
          totalBorrowedInput.value = totalBorrowed;

          updateDateTime();

          conditionGoodInput.max = totalBorrowed;
          conditionDamagedInput.max = totalBorrowed;
          conditionMissingInput.max = totalBorrowed;

          [
            conditionGoodInput,
            conditionDamagedInput,
            conditionMissingInput,
          ].forEach((input) => {
            input.addEventListener("input", validateReturnQuantities);
          });

          returnModal.classList.add("show");
        }

        // Open condition modal (if exists)
        function openConditionModal(itemName) {
          if (!conditionModal) return;
          conditionItemNameInput.value = itemName;
          conditionReportTextarea.value = "";
          conditionModal.classList.add("show");
        }

        // Close condition modal (if exists)
        function closeConditionModal() {
          if (!conditionModal) return;
          conditionModal.classList.remove("show");
        }

        // Validate return quantities in real-time
        function validateReturnQuantities() {
          const goodCount = parseInt(conditionGoodInput.value) || 0;
          const damagedCount = parseInt(conditionDamagedInput.value) || 0;
          const missingCount = parseInt(conditionMissingInput.value) || 0;
          const totalReturned = goodCount + damagedCount + missingCount;
          const totalBorrowed = parseInt(totalBorrowedInput.value);

          validationContainer.style.display = "block";

          if (totalReturned === 0) {
            validationIcon.innerHTML = "✗";
            validationText.textContent = `Return failed (0 of ${totalBorrowed})`;
            validationContainer.style.backgroundColor = "#f8d7da";
            validationContainer.style.borderLeftColor = "#dc3545";
          } else if (totalReturned > totalBorrowed) {
            validationIcon.innerHTML = "⚠️";
            validationText.textContent = `You're returning too many items (${totalReturned} of ${totalBorrowed})`;
            validationContainer.style.backgroundColor = "#fff3cd";
            validationContainer.style.borderLeftColor = "#ffc107";
          } else if (totalReturned < totalBorrowed) {
            validationIcon.innerHTML = "ℹ️";
            validationText.textContent = `Remaining returned (${totalReturned} of ${totalBorrowed})`;
            validationContainer.style.backgroundColor = "#e7f5ff";
            validationContainer.style.borderLeftColor = "#0d6efd";
          } else {
            validationIcon.innerHTML = "✓";
            validationText.textContent = `All items accounted for (${totalReturned} of ${totalBorrowed})`;
            validationContainer.style.backgroundColor = "#e8f7ee";
            validationContainer.style.borderLeftColor = "#198754";
          }
        }
        // Close return modal
        function closeReturnModal() {
          returnModal.classList.remove("show");
        }

        // Show success alert
        function showSuccessAlert(message) {
          const alertDiv = document.createElement("div");
          alertDiv.className = "custom-alert";
          alertDiv.style.cssText = `
                  position: fixed;
                  top: 20px;
                  left: 50%;
                  transform: translateX(-50%);
                  background-color: #4CAF50;
                  color: white;
                  padding: 10px 15px;
                  border-radius: 8px;
                  display: flex;
                  align-items: center;
                  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                  z-index: 2000;
                  animation: slideIn 0.5s, fadeOut 0.5s 2.5s;
                  max-width: 90%;
                  width: auto;
                  font-size: 14px;
                  box-sizing: border-box;
              `;

          const checkIcon = document.createElement("span");
          checkIcon.innerHTML = "✓";
          checkIcon.style.cssText = `
                  font-size: 20px;
                  margin-right: 10px;
              `;

          const messageText = document.createElement("span");
          messageText.textContent = message;
          messageText.style.cssText = `
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  max-width: 80vw;
              `;

          alertDiv.appendChild(checkIcon);
          alertDiv.appendChild(messageText);
          document.body.appendChild(alertDiv);

          setTimeout(() => {
            if (alertDiv.parentNode) {
              alertDiv.parentNode.removeChild(alertDiv);
            }
          }, 3000);
        }

        function showIncompleteAlert(message) {
          const alertDiv = document.createElement("div");
          alertDiv.className = "custom-alert-incomplete";
          alertDiv.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #e7f5ff;
        color: #0a58ca;
        padding: 10px 15px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        z-index: 2000;
        animation: slideIn 0.5s, fadeOut 0.5s 2.5s;
        max-width: 90%;
        width: auto;
        font-size: 14px;
        box-sizing: border-box;
        border-left: 4px solid #0d6efd;
    `;

          const infoIcon = document.createElement("span");
          infoIcon.innerHTML = "ℹ️";
          infoIcon.style.cssText = `
        font-size: 20px;
        margin-right: 10px;
    `;

          const messageText = document.createElement("span");
          messageText.textContent = message;
          messageText.style.cssText = `
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 80vw;
    `;

          alertDiv.appendChild(infoIcon);
          alertDiv.appendChild(messageText);
          document.body.appendChild(alertDiv);

          setTimeout(() => {
            if (alertDiv.parentNode) {
              alertDiv.parentNode.removeChild(alertDiv);
            }
          }, 3000);
        }

        // Show error alert
        function showErrorAlert(message) {
          const alertDiv = document.createElement("div");
          alertDiv.className = "custom-alert-error";
          alertDiv.style.cssText = `
                  position: fixed;
                  top: 20px;
                  left: 50%;
                  transform: translateX(-50%);
                  background-color: #f44336;
                  color: white;
                  padding: 10px 15px;
                  border-radius: 8px;
                  display: flex;
                  align-items: center;
                  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                  z-index: 2000;
                  animation: slideIn 0.5s, fadeOut 0.5s 2.5s;
                  max-width: 90%;
                  width: auto;
                  font-size: 14px;
                  box-sizing: border-box;
              `;

          const errorIcon = document.createElement("span");
          errorIcon.innerHTML = "✗";
          errorIcon.style.cssText = `
                  font-size: 20px;
                  margin-right: 10px;
              `;

          const messageText = document.createElement("span");
          messageText.textContent = message;
          messageText.style.cssText = `
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  max-width: 80vw;
              `;

          alertDiv.appendChild(errorIcon);
          alertDiv.appendChild(messageText);
          document.body.appendChild(alertDiv);

          setTimeout(() => {
            if (alertDiv.parentNode) {
              alertDiv.parentNode.removeChild(alertDiv);
            }
          }, 3000);
        }

        // Add minimal CSS for indicators
        const style = document.createElement("style");
        style.textContent = `
              @keyframes slideIn {
                  from { top: -50px; opacity: 0; }
                  to { top: 20px; opacity: 1; }
              }
              @keyframes fadeOut {
                  from { opacity: 1; }
                  to { opacity: 0; }
              }

              .item-indicator {
                  color: white;
              }

              .item-indicator.green {
                  background-color: #28a745;
              }

              .item-indicator.yellow {
                  background-color: #edc531;
                  color: white;
              }

              .item-indicator.orange {
                  background-color: #f0750f;
              }
          `;
        document.head.appendChild(style);

        // Initialize indicators on page load
        initializeIndicators();

        // Event listeners for borrow buttons
        borrowBtns.forEach((btn) => {
          btn.addEventListener("click", function () {
            const card = this.closest(".card");
            const itemName = card.querySelector("h3").textContent;
            openBorrowModal(itemName);
          });
        });

        // Event listeners for return buttons
        returnBtns.forEach((btn) => {
          btn.addEventListener("click", function () {
            const card = this.closest(".card");
            const itemName = card.querySelector("h3").textContent;
            openReturnModal(itemName);
          });
        });

        // Event listeners for condition report buttons (if exists)
        if (conditionModal) {
          document.querySelectorAll(".condition-report-btn").forEach((btn) => {
            btn.addEventListener("click", function () {
              const card = this.closest(".card");
              const itemName = card.querySelector("h3").textContent;
              openConditionModal(itemName);
            });
          });
        }

        // Close buttons
        closeBtn.addEventListener("click", closeBorrowModal);
        cancelBtn.addEventListener("click", closeBorrowModal);
        closePwBtn.addEventListener("click", closePasswordModal);
        cancelPwBtn.addEventListener("click", closePasswordModal);
        returnCloseBtn.addEventListener("click", closeReturnModal);
        returnCancelBtn.addEventListener("click", closeReturnModal);
        if (conditionModalClose) {
          conditionModalClose.addEventListener("click", closeConditionModal);
        }

        // Quantity controls
        decreaseBtn.addEventListener("click", () => {
          let currentValue = parseInt(quantityInput.value);
          if (currentValue > 1) quantityInput.value = currentValue - 1;
        });

        increaseBtn.addEventListener("click", () => {
          let currentValue = parseInt(quantityInput.value);
          const maxQuantity = parseInt(quantityInput.max);
          if (currentValue < maxQuantity)
            quantityInput.value = currentValue + 1;
        });

        // Submit to password modal
        submitBtn.addEventListener("click", () => {
          const itemName = itemNameInput.value;
          const quantity = parseInt(quantityInput.value);
          const currentQuantity = getCurrentQuantity(itemName);

          if (quantity > currentQuantity) {
            showErrorAlert(
              `Cannot borrow ${quantity} items - only ${currentQuantity} available`
            );
            return;
          }

          const tempBorrowData = {
            itemName: itemName,
            quantity: quantity,
            studentName: studentNameInput.value,
            studentCourse: studentCourseInput.value,
            borrowDate: borrowDateInput.value,
          };

          localStorage.setItem(
            "tempBorrowData",
            JSON.stringify(tempBorrowData)
          );

          closeBorrowModal();
          openPasswordModal();
        });

        // Password confirmation
        confirmPwBtn.addEventListener("click", () => {
          if (!passwordInput.value.trim()) {
            passwordError.textContent = "Please enter your password";
            passwordError.style.display = "block";
            return;
          }

          if (passwordInput.value === CORRECT_PASSWORD) {
            const tempBorrowData = JSON.parse(
              localStorage.getItem("tempBorrowData")
            );

            if (tempBorrowData) {
              const { itemName, quantity, studentName, studentCourse } =
                tempBorrowData;

              if (!borrowedItems[itemName]) {
                borrowedItems[itemName] = [];
              }

              borrowedItems[itemName].push({
                quantity: quantity,
                studentName: studentName,
                studentCourse: studentCourse,
                borrowDate: new Date().toLocaleString(),
              });

              saveBorrowedItems();
              updateAllItemIndicators();

              // Updated success message to show quantity
              const plural = quantity > 1 ? "s" : "";
              showSuccessAlert(
                `Successfully borrowed ${quantity} ${itemName}${plural}`
              );

              localStorage.removeItem("tempBorrowData");
            }
            closePasswordModal();
          } else {
            passwordError.textContent = "Incorrect password. Please try again.";
            passwordError.style.display = "block";
            passwordInput.value = "";
          }
        });
        // Return item submission with partial returns allowed
        returnSubmitBtn.addEventListener("click", () => {
          const itemName = itemNameReturnInput.value;
          const goodCount = parseInt(conditionGoodInput.value) || 0;
          const damagedCount = parseInt(conditionDamagedInput.value) || 0;
          const missingCount = parseInt(conditionMissingInput.value) || 0;
          const totalReturned = goodCount + damagedCount + missingCount;
          const totalBorrowed = parseInt(totalBorrowedInput.value);

          // Validation cases that should prevent submission
          if (totalReturned === 0) {
            showErrorAlert(
              `Return failed - No items returned (0 of ${totalBorrowed})`
            );
            return;
          }

          if (totalReturned > totalBorrowed) {
            showErrorAlert(
              `Cannot return ${totalReturned} items - only ${totalBorrowed} were borrowed (${totalReturned} of ${totalBorrowed})`
            );
            return;
          }

          // Handle successful return (full or partial)
          if (totalReturned === totalBorrowed) {
            let successMessage = `Successfully returned all ${totalReturned} ${itemName} items`;

            // Add condition details if any items were damaged or missing
            if (damagedCount > 0 || missingCount > 0) {
              const conditionDetails = [];
              if (damagedCount > 0)
                conditionDetails.push(`${damagedCount} damaged`);
              if (missingCount > 0)
                conditionDetails.push(`${missingCount} missing`);
              successMessage += ` (${conditionDetails.join(" and ")})`;
            }

            showSuccessAlert(successMessage);
          } else {
            let incompleteMessage = `Return incomplete - ${totalReturned} of ${totalBorrowed} ${itemName} items returned`;

            // Add condition details if any items were damaged or missing
            if (damagedCount > 0 || missingCount > 0) {
              const conditionDetails = [];
              if (damagedCount > 0)
                conditionDetails.push(`${damagedCount} damaged`);
              if (missingCount > 0)
                conditionDetails.push(`${missingCount} missing`);
              incompleteMessage += ` (${conditionDetails.join(" and ")})`;
            }

            showIncompleteAlert(incompleteMessage);
          }

          // Update inventory - remove the returned items from borrowedItems
          if (borrowedItems[itemName]) {
            // For partial returns, we need to adjust the remaining quantity
            if (totalReturned < totalBorrowed) {
              // Find the most recent borrow record to modify
              const mostRecentRecord = borrowedItems[itemName].reduce(
                (latest, record) =>
                  new Date(record.borrowDate) > new Date(latest.borrowDate)
                    ? record
                    : latest
              );

              // Reduce the quantity in the most recent record
              mostRecentRecord.quantity -= totalReturned;

              // If quantity reaches zero, remove the record
              if (mostRecentRecord.quantity <= 0) {
                borrowedItems[itemName] = borrowedItems[itemName].filter(
                  (record) => record !== mostRecentRecord
                );
              }
            } else {
              // Full return - remove all records for this item
              delete borrowedItems[itemName];
            }

            saveBorrowedItems();
            updateAllItemIndicators();
          }

          closeReturnModal();
        });

        // Clear password error on input
        passwordInput.addEventListener("input", () => {
          if (passwordInput.value.trim()) {
            passwordError.style.display = "none";
          }
        });

        // Close modals when clicking outside
        window.addEventListener("click", (event) => {
          if (event.target === borrowModal) closeBorrowModal();
          if (event.target === passwordModal) {
            localStorage.removeItem("tempBorrowData");
            closePasswordModal();
          }
          if (event.target === returnModal) closeReturnModal();
          if (conditionModal && event.target === conditionModal)
            closeConditionModal();
        });

        // Submit password on Enter key
        passwordInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") confirmPwBtn.click();
        });
      });

      // Logout Modal Functionality
      const logoutModal = document.querySelector(".logout-modal");
      const logoutLink = document.getElementById("logoutLink");
      const confirmLogoutBtn = document.getElementById("confirmLogout");
      const cancelLogoutBtn = document.getElementById("cancelLogout");

      // Show modal when logout link is clicked
      logoutLink.addEventListener("click", function (e) {
        e.preventDefault();
        logoutModal.classList.add("show");
      });

      // Close modal when 'Cancel' is clicked
      cancelLogoutBtn.addEventListener("click", function () {
        logoutModal.classList.remove("show");
      });

      // Redirect to login page when 'Logout' is clicked
      confirmLogoutBtn.addEventListener("click", function () {
        logoutModal.classList.remove("show");
        setTimeout(function () {
          window.location.href = "login.html";
        }, 300);
      });

      // Close modal when clicking outside of it
      window.addEventListener("click", function (event) {
        if (event.target == logoutModal) {
          logoutModal.classList.remove("show");
        }
      });
    </script>
  </body>
</html>
